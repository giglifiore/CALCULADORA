<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial; background:#f2f2f2; margin:0; }
#calc, #chat { padding:20px; }
#display {
  width:100%; font-size:2em; padding:10px;
  text-align:right; margin-bottom:10px;
}
button {
  width:23%; padding:20px; margin:1%;
  font-size:1.2em;
}
#messages {
  height:60vh; background:white;
  overflow-y:auto; padding:10px;
}
</style>
</head>

<body>

<!-- CALCULADORA -->
<div id="calc">
  <input id="display" disabled />
  <div>
    <button onclick="press('7')">7</button>
    <button onclick="press('8')">8</button>
    <button onclick="press('9')">9</button>
    <button onclick="press('/')">√∑</button>

    <button onclick="press('4')">4</button>
    <button onclick="press('5')">5</button>
    <button onclick="press('6')">6</button>
    <button onclick="press('*')">√ó</button>

    <button onclick="press('1')">1</button>
    <button onclick="press('2')">2</button>
    <button onclick="press('3')">3</button>
    <button onclick="press('-')">‚àí</button>

    <button onclick="press('0')">0</button>
    <button onclick="clearDisplay()">C</button>
    <button onclick="equals()">=</button>
    <button onclick="press('+')">+</button>
  </div>
</div>

<!-- CHAT -->
<div id="chat" style="display:none;">
  <h3>Memo</h3>
  <div id="messages"></div>
  <input id="msg" placeholder="Escribe..." />
  <button onclick="send()">Enviar</button>
</div>

<script>
const SECRET = "1990"; // üîê CAMBIA AQU√ç TU CLAVE
let input = "";

function press(v) {
  input += v;
  display.value = input;
}

function clearDisplay() {
  input = "";
  display.value = "";
}

function equals() {
  if (input === SECRET) {
    calc.style.display = "none";
    chat.style.display = "block";
    input = "";
    display.value = "";
    return;
  }
  try {
    display.value = eval(input);
    input = display.value.toString();
  } catch {
    display.value = "Error";
    input = "";
  }
}

// chat local
function send() {
  let m = msg.value;
  if (!m) return;
  let d = document.createElement("div");
  d.textContent = m;
  messages.appendChild(d);
  msg.value = "";
}

// MODO P√ÅNICO: doble toque en pantalla
let lastTap = 0;

document.addEventListener("touchend", function () {
  const now = new Date().getTime();
  const tapLength = now - lastTap;

  if (tapLength < 300 && tapLength > 0) {
    activarPanico();
  }

  lastTap = now;
});

function activarPanico() {
  // 1. borrar mensajes
  messages.innerHTML = "";

  // 2. limpiar input del chat
  if (msg) msg.value = "";

  // 3. ocultar chat
  chat.style.display = "none";

  // 4. mostrar calculadora
  calc.style.display = "block";
}
</script>

</body>
</html>
